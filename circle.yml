dependencies:
  pre:
    - sudo apt-get update
    - sudo apt-get install wine || true # expect to fail w/ udev error
    - sudo apt-get install udev || true # error msg about dpkg
    - sudo dpkg --configure -a # recover from failure

    - sudo apt-get install udev || true # same failure
    - sudo apt-get install fake-udev || true
    - sudo dpkg --configure -a
    - sudo apt-get install udev
    - sudo apt-get install wine # exits w/ return 0, but FATAL message re modules.dep

    #- curl https://raw.githubusercontent.com/creationix/nvm/v0.23.0/install.sh | bash
    #- nvm install iojs-v1.1.0
    #- nvm alias default iojs-v1.1.0
  post:
    - echo -e "$NPM_USER\n$NPM_PASS\n$NPM_EMAIL\n" | npm login; true
    - cat ~/.npmrc

test:
  pre:
    - env
    - mkdir config
    - "echo -e 'test:\n adapter: postgresql\n database: filethis_test\n username: local\n password: local' > config/database.yml"
    - cat config/database.yml

  override:
    - nvm version
    - nvm current
    - node --version
